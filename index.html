<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ricerca Record & Watt & Percentuale</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
        .container {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        .input-group {
            margin-bottom: 1.5rem;
        }
        .input-group label {
            display: block;
            color: #4b5563;
            font-weight: 600;
            margin-bottom: 0.5rem;
            text-align: left;
        }
        .input-group select {
            width: 100%;
            padding: 0.75rem;
            border-radius: 0.5rem;
            border: 1px solid #d1d5db;
            outline: none;
            cursor: pointer;
        }
        .input-group select:focus {
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.2);
        }
        .result-container {
            margin-top: 1rem;
            padding: 1.5rem;
            background-color: #e0e7ff;
            border-radius: 0.5rem;
            font-size: 1.5rem;
            font-weight: 600;
            color: #1e40af;
            min-height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease-in-out;
        }
        .error-container {
            background-color: #fecaca;
            color: #7f1d1d;
        }
    </style>
</head>
<body>

<div class="container">
    <h1 class="text-3xl font-bold text-gray-800 mb-6">Trova il Tempo & i Watt</h1>
    
    <div class="input-group">
        <label for="nameSelect">Seleziona un nome:</label>
        <select id="nameSelect" class="w-full" onchange="findTime()">
            <option value="">Seleziona un nome...</option>
            <option value="ABAGNALE">ABAGNALE</option>
            <option value="ABBAGNALE">ABBAGNALE</option>
            <option value="ALBORGHETTI">ALBORGHETTI</option>
            <option value="ANGELLA">ANGELLA</option>
            <option value="ANIELLO">ANIELLO</option>
            <option value="ASCALONE">ASCALONE</option>
            <option value="BELGERI">BELGERI</option>
            <option value="BELLOMO">BELLOMO</option>
            <option value="BENVENUTI">BENVENUTI</option>
            <option value="BIZZOZERO">BIZZOZERO</option>
            <option value="BOLDRINO">BOLDRINO</option>
            <option value="BONAMONETA">BONAMONETA</option>
            <option value="BORIELLO">BORIELLO</option>
            <option value="BOSIO">BOSIO</option>
            <option value="BOTTIGNON">BOTTIGNON</option>
            <option value="BUMBACA">BUMBACA</option>
            <option value="CAPPONI">CAPPONI</option>
            <option value="CARUCCI">CARUCCI</option>
            <option value="CESARINI">CESARINI</option>
            <option value="CHIUMIENTO">CHIUMIENTO</option>
            <option value="CIAVARRO">CIAVARRO</option>
            <option value="CODATO G">CODATO G</option>
            <option value="CODATO A">CODATO A</option>
            <option value="COLASANTE">COLASANTE</option>
            <option value="CARAMASCHI">CARAMASCHI</option>
            <option value="COMINI">COMINI</option>
            <option value="COVINI">COVINI</option>
            <option value="CUZZOCREA">CUZZOCREA</option>
            <option value="DE FILIPPIS">DE FILIPPIS</option>
            <option value="DELLA VALLE">DELLA VALLE</option>
            <option value="DI COLANDREA">DI COLANDREA</option>
            <option value="DI MAURO">DI MAURO</option>
            <option value="FRIGERIO">FRIGERIO</option>
            <option value="GAETANI LISEO">GAETANI LISEO</option>
            <option value="GANDOLA">GANDOLA</option>
            <option value="GATTI">GATTI</option>
            <option value="GLIA">GLIA</option>
            <option value="GENTILI">GENTILI</option>
            <option value="GARDINO">GARDINO</option>
            <option value="GNATTA">GNATTA</option>
            <option value="GOBBI">GOBBI</option>
            <option value="GUERRA">GUERRA</option>
            <option value="KIRIKOHL">KIRIKOHL</option>
            <option value="LICATOSI">LICATOSI</option>
            <option value="LODO">LODO</option>
            <option value="MARVUCIC">MARVUCIC</option>
            <option value="MELEGARI">MELEGARI</option>
            <option value="MERIANO">MERIANO</option>
            <option value="MERLINI">MERLINI</option>
            <option value="MONACI">MONACI</option>
            <option value="MONDELLI">MONDELLI</option>
            <option value="MONFRECOLA">MONFRECOLA</option>
            <option value="MULAS">MULAS</option>
            <option value="MUMOLO">MUMOLO</option>
            <option value="NICHIFOR">NICHIFOR</option>
            <option value="OPPO">OPPO</option>
            <option value="PALLOZZI">PALLOZZI</option>
            <option value="PANIZZA">PANIZZA</option>
            <option value="PAPPALEPORE">PAPPALEPORE</option>
            <option value="PAPPALETTERA">PAPPALETTERA</option>
            <option value="PAZZAGLI">PAZZAGLI</option>
            <option value="PEDROLA">PEDROLA</option>
            <option value="PELACCHI">PELACCHI</option>
            <option value="PERETTI">PERETTI</option>
            <option value="PIETRA CAPRINA">PIETRA CAPRINA</option>
            <option value="PRATI">PRATI</option>
            <option value="RAMBALDI">RAMBALDI</option>
            <option value="RAMELLA">RAMELLA</option>
            <option value="RENZI">RENZI</option>
            <option value="RICELLI">RICELLI</option>
            <option value="ROCCHI">ROCCHI</option>
            <option value="ROCEK">ROCEK</option>
            <option value="ROCEK P">ROCEK P</option>
            <option value="RODINI">RODINI</option>
            <option value="ROSSI">ROSSI</option>
            <option value="RUTA">RUTA</option>
            <option value="SANDRINI">SANDRINI</option>
            <option value="SARTORI">SARTORI</option>
            <option value="SCALZONE">SCALZONE</option>
            <option value="SCIATTELLA">SCIATTELLA</option>
            <option value="SCOLARO">SCOLARO</option>
            <option value="SELVA">SELVA</option>
            <option value="SOARES">SOARES</option>
            <option value="SOLDO">SOLDO</option>
            <option value="SORRENTINO">SORRENTINO</option>
            <option value="SPIRITO">SPIRITO</option>
            <option value="TEDOLDI">TEDOLDI</option>
            <option value="TERRAZZI">TERRAZZI</option>
            <option value="TIMPANARO">TIMPANARO</option>
            <option value="TORRE">TORRE</option>
            <option value="VERITà">VERITà</option>
            <option value="VICINO G">VICINO G</option>
            <option value="VICINO L">VICINO L</option>
            <option value="VICINO M">VICINO M</option>
        </select>
    </div>
    
    <div id="time-result-container" class="result-container text-red-900">
        Seleziona un nome
    </div>

    <div id="time-divided-result-container" class="result-container mt-4">
        Media
    </div>

    <div id="watt-result-container" class="result-container mt-4">
        Watt Record
    </div>
    
    <div class="input-group mt-6">
    <label for="percentageSelect">Seleziona una percentuale:</label>
    <select id="percentageSelect" class="w-full" onchange="calculateWattsWithPercentage()">
        <option value="">Seleziona una percentuale...</option>
        <option value="50">50%</option>
        <option value="55">55%</option>
        <option value="60">60%</option>
        <option value="65">65%</option>
        <option value="70">70%</option>
        <option value="75">75%</option>
        <option value="80">80%</option>
        <option value="85">85%</option>
        <option value="90">90%</option>
        <option value="95">95%</option>
        <option value="100">100%</option>
        <option value="105">105%</option>
        <option value="110">110%</option>
        <option value="115">115%</option>
        <option value="120">120%</option>
        <option value="125">125%</option>
        <option value="130">130%</option>
    </select>
</div>

    <div id="percentage-time-result-container" class="result-container mt-4">
        Tempo dispendio
    </div>

    <div id="percentage-time-divided-result-container" class="result-container mt-4">
        Media Dispendio
    </div>
    
    <div id="percentage-watt-result-container" class="result-container mt-4">
        Watt - dispendio
    </div>

</div>

<script>
    // Global variable to store the base watts (100%)
    let baseWatts = 0;

    // Dati dei nomi e dei tempi
    const times = {
        "ABAGNALE": "05:52.0",
        "ABBAGNALE": "05:57.0",
        "ALBORGHETTI": "05:59.0",
        "ANGELLA": "06:04.9",
        "ANIELLO": "05:55.0",
        "ASCALONE": "07:16.0",
        "BELGERI": "06:03.0",
        "BELLOMO": "05:58.3",
        "BENVENUTI": "07:10.0",
        "BIZZOZERO": "06:03.4",
        "BOLDRINO": "07:17.0",
        "BONAMONETA": "06:00.2",
        "BORIELLO": "06:58.7",
        "BOSIO": "06:56.0",
        "BOTTIGNON": "07:04.0",
        "BUMBACA": "06:51.0",
        "CAPPONI": "00:00.0",
        "CARUCCI": "05:55.0",
        "CESARINI": "07:04.8",
        "CHIUMIENTO": "05:52.0",
        "CIAVARRO": "06:01.2",
        "CODATO G": "05:59.6",
        "CODATO A": "06:41.9",
        "COLASANTE": "06:59.0",
        "CARAMASCHI": "06:04.0",
        "COMINI": "05:57.2",
        "COVINI": "06:04.0",
        "CUZZOCREA": "07:03.7",
        "DE FILIPPIS": "07:05.0",
        "DELLA VALLE": "05:59.7",
        "DI COLANDREA": "06:00.0",
        "DI MAURO": "05:40.0",
        "FRIGERIO": "05:56.0",
        "GAETANI LISEO": "05:56.0",
        "GANDOLA": "05:58.6",
        "GATTI": "07:15.1",
        "GLIA": "07:15.1",
        "GENTILI": "05:50.0",
        "GARDINO": "06:07.8",
        "GNATTA": "06:57.0",
        "GOBBI": "06:55.0",
        "GUERRA": "06:54.5",
        "KIRIKOHL": "07:00.0",
        "LICATOSI": "06:03.2",
        "LODO": "05:56.0",
        "MARVUCIC": "06.01",
        "MELEGARI": "06:05.7",
        "MERIANO": "06:48.0",
        "MERLINI": "07:09.0",
        "MONACI": "07:06.0",
        "MONDELLI": "06:49.0",
        "MONFRECOLA": "05:55.0",
        "MULAS": "06:12.0",
        "MUMOLO": "05:56.0",
        "NICHIFOR": "07:00.0",
        "OPPO": "06:03.8",
        "PALLOZZI": "05:59.0",
        "PANIZZA": "05:42.0",
        "PAPPALEPORE": "05:59.0",
        "PAPPALETTERA": "06:05.0",
        "PAZZAGLI": "06:11.6",
        "PEDROLA": "07:05.0",
        "PELACCHI": "06:53.7",
        "PERETTI": "06:01.0",
        "PIETRA CAPRINA": "05:57.0",
        "PRATI": "06:05.0",
        "RAMBALDI": "05:44.0",
        "RAMELLA": "07:14.0",
        "RENZI": "06:06.0",
        "RICELLI": "05:57.9",
        "ROCCHI": "06:04.0",
        "ROCEK": "06:48.0",
        "ROCEK P": "06:09.0",
        "RODINI": "06:58.7",
        "ROSSI": "07:05.0",
        "RUTA": "06:07.0",
        "SANDRINI": "06:06.7",
        "SARTORI": "05:55.3",
        "SCALZONE": "06:04.0",
        "SCIATTELLA": "07:08.0",
        "SCOLARO": "07:15.0",
        "SELVA": "06:07.0",
        "SOARES": "06:05.0",
        "SOLDO": "06:09.9",
        "SORRENTINO": "06:07.0",
        "SPIRITO": "07:07.0",
        "TEDOLDI": "05:58.0",
        "TERRAZZI": "06:47.0",
        "TIMPANARO": "06:14.0",
        "TORRE": "05:59.2",
        "VERITà": "05:55.0",
        "VICINO G": "05:52.0",
        "VICINO L": "06:02.0",
        "VICINO M": "06:01.0"
    };

    /**
     * Converte una stringa di tempo (es. "MM:SS.S" o "MM.SS") in secondi totali.
     * @param {string} timeString La stringa di tempo da convertire.
     * @returns {number} Il tempo totale in secondi.
     */
    function convertTimeToSeconds(timeString) {
        // Gestisce il formato 06.01, convertendolo in 06:01
        if (timeString.includes('.')) {
            timeString = timeString.replace('.', ':');
        }
        
        const parts = timeString.split(':').map(part => parseFloat(part));
        const minutes = parts[0] || 0;
        const seconds = parts[1] || 0;

        return (minutes * 60) + seconds;
    }

    /**
     * Calcola i Watt in base a un tempo totale in secondi.
     * @param {number} totalSeconds Il tempo totale in secondi.
     * @returns {number} I Watt calcolati.
     */
    function calculateWatts(totalSeconds) {
        if (totalSeconds === 0) {
            return 0; // Evita la divisione per zero
        }
        return 2.8 * Math.pow(2000 / totalSeconds, 3);
    }
    
    /**
     * Converte i secondi totali in una stringa "MM:SS.S".
     * @param {number} totalSeconds Il tempo totale in secondi.
     * @returns {string} La stringa di tempo formattata.
     */
    function formatSecondsToTime(totalSeconds) {
        const minutes = Math.floor(totalSeconds / 60);
        const seconds = totalSeconds % 60;
        const formattedSeconds = seconds.toFixed(1);
        
        const minutesString = String(minutes).padStart(2, '0');
        const secondsString = String(formattedSeconds).padStart(4, '0');
        
        return `${minutesString}:${secondsString}`;
    }

    /**
     * Esegue la ricerca del tempo e il calcolo dei Watt.
     */
    function findTime() {
        const selectedName = document.getElementById('nameSelect').value;
        const timeResultContainer = document.getElementById('time-result-container');
        const timeDividedResultContainer = document.getElementById('time-divided-result-container');
        const wattResultContainer = document.getElementById('watt-result-container');
        const percentageSelect = document.getElementById('percentageSelect');
        const percentageWattResultContainer = document.getElementById('percentage-watt-result-container');
        const percentageTimeResultContainer = document.getElementById('percentage-time-result-container');
        const percentageTimeDividedResultContainer = document.getElementById('percentage-time-divided-result-container');

        // Imposta i valori di default per i contenitori delle percentuali.
        percentageWattResultContainer.textContent = "Watt - dispendio";
        percentageTimeResultContainer.textContent = "Tempo dispendio";
        percentageTimeDividedResultContainer.textContent = "Media Dispendio";
        
        // Se non è stato selezionato un nome, mostra un messaggio di default
        if (selectedName === "") {
            timeResultContainer.textContent = "Seleziona un nome";
            timeResultContainer.classList.add('text-red-900');
            timeResultContainer.classList.remove('error-container');
            timeDividedResultContainer.textContent = "Media";
            wattResultContainer.textContent = "Watt Record";
            timeDividedResultContainer.classList.remove('error-container');
            wattResultContainer.classList.remove('error-container');
            baseWatts = 0; // Reset della variabile globale
            percentageSelect.value = ""; // Reset della selezione percentuale
            return;
        }

        // Cerca il tempo corrispondente al nome
        const timeString = times[selectedName];

        if (timeString) {
            // Mostra il tempo
            timeResultContainer.textContent = `Tempo: ${timeString}`;
            timeResultContainer.classList.remove('text-red-900');
            timeResultContainer.classList.remove('error-container');

            // Converte il tempo in secondi
            const totalSeconds = convertTimeToSeconds(timeString);

            // Calcola e mostra il tempo diviso per 4
            const timeDividedByFour = totalSeconds / 4;
            const formattedTimeDivided = formatSecondsToTime(timeDividedByFour);
            timeDividedResultContainer.textContent = `Media: ${formattedTimeDivided}`;
            timeDividedResultContainer.classList.remove('error-container');
            
            // Calcola i Watt base (100%)
            baseWatts = calculateWatts(totalSeconds);

            // Se il tempo è 0, mostra un messaggio di errore per il calcolo
            if (totalSeconds === 0) {
                wattResultContainer.textContent = "Tempo non valido per il calcolo.";
                wattResultContainer.classList.add('error-container');
                percentageWattResultContainer.textContent = "Impossibile calcolare i Watt percentuali.";
                percentageWattResultContainer.classList.add('error-container');
                percentageTimeResultContainer.textContent = "Impossibile calcolare il tempo percentuale.";
                percentageTimeResultContainer.classList.add('error-container');
                percentageTimeDividedResultContainer.textContent = "Impossibile calcolare il tempo percentuale / 4.";
                percentageTimeDividedResultContainer.classList.add('error-container');
            } else {
                // Mostra il risultato dei Watt, arrotondato a due decimali
                wattResultContainer.textContent = `Watt Record: ${baseWatts.toFixed(2)}`;
                wattResultContainer.classList.remove('error-container');
            }

            // Calcola e mostra i Watt e il tempo percentuali quando un nome viene selezionato
            calculateWattsWithPercentage();

        } else {
            // Gestisce il caso in cui il nome non venga trovato
            timeResultContainer.textContent = "Nome non trovato.";
            wattResultContainer.textContent = "Impossibile calcolare i Watt.";
            timeDividedResultContainer.textContent = "Impossibile calcolare la media.";
            percentageWattResultContainer.textContent = "Impossibile calcolare i Watt percentuali.";
            percentageTimeResultContainer.textContent = "Impossibile calcolare il tempo dispendio.";
            percentageTimeDividedResultContainer.textContent = "Impossibile calcolare la media dispendio.";
            timeResultContainer.classList.add('error-container');
            wattResultContainer.classList.add('error-container');
            timeDividedResultContainer.classList.add('error-container');
            percentageWattResultContainer.classList.add('error-container');
            percentageTimeResultContainer.classList.add('error-container');
            percentageTimeDividedResultContainer.classList.add('error-container');
        }
    }
    
    /**
     * Calcola e mostra i Watt e il tempo in base alla percentuale selezionata.
     */
    function calculateWattsWithPercentage() {
        const selectedPercentage = document.getElementById('percentageSelect').value;
        const percentageWattResultContainer = document.getElementById('percentage-watt-result-container');
        const percentageTimeResultContainer = document.getElementById('percentage-time-result-container');
        const percentageTimeDividedResultContainer = document.getElementById('percentage-time-divided-result-container');

        // Se non è selezionata una percentuale, non fare nulla.
        if (!selectedPercentage || baseWatts === 0) {
            return;
        }

        const percentage = parseFloat(selectedPercentage) / 100;
        const finalWatts = baseWatts * percentage;
        
        // Calcola il tempo in base ai nuovi Watt
        let finalTimeInSeconds = 0;
        if (finalWatts > 0) {
            finalTimeInSeconds = 2000 / Math.pow(finalWatts / 2.8, 1/3);
        }

        const formattedTime = formatSecondsToTime(finalTimeInSeconds);
        
        // Calcola e mostra il tempo percentuale diviso per 4
        const finalTimeDividedByFour = finalTimeInSeconds / 4;
        const formattedFinalTimeDivided = formatSecondsToTime(finalTimeDividedByFour);

        percentageWattResultContainer.textContent = `Watt - dispendio (${selectedPercentage}%): ${finalWatts.toFixed(2)}`;
        percentageWattResultContainer.classList.remove('error-container');
        
        percentageTimeResultContainer.textContent = `Tempo dispendio (${selectedPercentage}%): ${formattedTime}`;
        percentageTimeResultContainer.classList.remove('error-container');

        percentageTimeDividedResultContainer.textContent = `Media Dispendio (${selectedPercentage}%): ${formattedFinalTimeDivided}`;
        percentageTimeDividedResultContainer.classList.remove('error-container');
    }
</script>

</body>
</html>
